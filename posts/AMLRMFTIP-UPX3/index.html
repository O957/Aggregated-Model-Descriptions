<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="O957">
<meta name="dcterms.date" content="2024-09-01">
<meta name="description" content="This model is the first in a series of statistical models for forecasting tornadoes, as part of a question featured on Metaculus.">

<title>A Multilevel Regression Model For Tornadoes, In Python – A STATISTICAL MODELING GUILD</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../icon.jpg" rel="icon" type="image/jpeg">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-1df595aef21d6855306221acafa31604.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">A STATISTICAL MODELING GUILD</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/O957"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">A Multilevel Regression Model For Tornadoes, In Python</h1>
                  <div>
        <div class="description">
          <em>This model is the first in a series of statistical models for forecasting tornadoes, as part of a question featured on Metaculus.</em>
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">modeling</div>
                <div class="quarto-category">data-science</div>
                <div class="quarto-category">mathematics</div>
              </div>
                  </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-heading">Affiliation</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author"><a href="https://github.com/O957">O957</a> </p>
    </div>
    <div class="quarto-title-meta-contents">
          <p class="affiliation">
              Independent
            </p>
        </div>
    </div>

  <div class="quarto-title-meta">

        
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">September 1, 2024</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">September 1, 2024</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#models" id="toc-models" class="nav-link" data-scroll-target="#models"><span class="header-section-number">2</span> Model(s)</a>
  <ul class="collapse">
  <li><a href="#implementation" id="toc-implementation" class="nav-link" data-scroll-target="#implementation"><span class="header-section-number">2.1</span> Implementation</a></li>
  <li><a href="#inference" id="toc-inference" class="nav-link" data-scroll-target="#inference"><span class="header-section-number">2.2</span> Inference</a>
  <ul class="collapse">
  <li><a href="#priors" id="toc-priors" class="nav-link" data-scroll-target="#priors"><span class="header-section-number">2.2.1</span> Priors</a></li>
  <li><a href="#prior-predictive-check" id="toc-prior-predictive-check" class="nav-link" data-scroll-target="#prior-predictive-check"><span class="header-section-number">2.2.2</span> Prior Predictive Check</a></li>
  <li><a href="#posterior-predictive-check" id="toc-posterior-predictive-check" class="nav-link" data-scroll-target="#posterior-predictive-check"><span class="header-section-number">2.2.3</span> Posterior Predictive Check</a></li>
  <li><a href="#posterior-samples" id="toc-posterior-samples" class="nav-link" data-scroll-target="#posterior-samples"><span class="header-section-number">2.2.4</span> Posterior Samples</a></li>
  <li><a href="#other-results" id="toc-other-results" class="nav-link" data-scroll-target="#other-results"><span class="header-section-number">2.2.5</span> Other Results</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#appendix" id="toc-appendix" class="nav-link" data-scroll-target="#appendix"><span class="header-section-number">3</span> Appendix</a>
  <ul class="collapse">
  <li><a href="#random-intercepts-and-slopes" id="toc-random-intercepts-and-slopes" class="nav-link" data-scroll-target="#random-intercepts-and-slopes"><span class="header-section-number">3.1</span> Random Intercepts And Slopes</a></li>
  <li><a href="#mcelreath-multilevel-modelling" id="toc-mcelreath-multilevel-modelling" class="nav-link" data-scroll-target="#mcelreath-multilevel-modelling"><span class="header-section-number">3.2</span> McElreath Multilevel Modelling</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">3.3</span> References</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>As with (likely) most of the other models in this repository, their raison d’être is to facilitate forecasting on <a href="https://en.wikipedia.org/wiki/Metaculus">Metaculus</a> question <a href="https://www.metaculus.com/questions/22307/tornadoes-in-the-united-states-in-april-2024/">22307</a>, which is part of the <a href="https://www.metaculus.com/tournament/bridgewater/">Bridgewater Forecasting Contest</a>. The resolution criteria for question 22307 reads:</p>
<blockquote class="blockquote">
<p>This question will resolve as the number of tornadoes in the United States in April of 2024, according to the <a href="https://www.spc.noaa.gov/climo/summary/">Storm Prediction Center’s preliminary tornado summary</a>.</p>
<p>If the resolution value is below the lower bound or above the upper bound, the question resolves outside the respective bound.</p>
<p>The question will resolve as the number of tornadoes shown for the month of April 2024 when accessed by Metaculus on May 3, 2024. If there is a discrepancy between the “Map” and “Tables” views, the question resolves to the figure displayed on the “Map” view.</p>
</blockquote>
<p>By the time you are reading this, the question has very likely closed. Also, given that the open upper bound on the question begins at 300 and that the National Oceanic and Atmospheric Administration’s (<a href="https://www.noaa.gov/">NOAA</a>) <a href="https://www.spc.noaa.gov/climo/summary/">Storm Prediction Center</a> reports 310 as the number of preliminary tornadoes across the USA in April 2024, you might be saying to yourself, how can this brief report help me? Well dear forecaster, should a similar question come up on Metaculus, even if it is not necessarily about tornadoes, then the following discussion—on <a href="https://en.wikipedia.org/wiki/Multilevel_model">multilevel modelling</a>—might enable you to produce better, more statistically informed Metaculus forecasts. There is additionally an argument to be made that <span class="math display">\[P(\text{Finds The Below Interesting } | \text{ Participates On Metaculus})\]</span> is high…but you can always stop reading at any time.</p>
<p>Before we begin, though, the author wants to note that NOAA does indeed permit data downloading; however, this process is quite tedious and annoying! Please commend the author on their patience manually copying the data into text files. The data available for use in modelling includes tornado, wind, and hail counts for each state, by month and year (1950 to 2024). Find the data <a href="https://github.com/O957/Forecasting-Tornadoes/tree/dev-118777/data/clean">here</a>. The author downloaded the <em>preliminary</em> report values (given that this is the forecasting target for question 22307) for January 2019 to March 2024. Final reports were not downloaded since for many months across many states in the distant past, these report values are still not available.</p>
<p><em>The author is still maturing mathematically</em>, so (please!) gaze upon the statistical sections with skeptical eyes. Note as well that the author operates by <a href="https://www.lesswrong.com/tag/crockers-rules">Crocker’s Rules</a>, so criticism is welcome. To critique, please make a new issue <a href="https://github.com/O957/Forecasting-Tornadoes/issues">here</a>. The following was informed in part from Richard McElreath’s 13th chapter of <a href="https://www.taylorfrancis.com/books/mono/10.1201/9780429029608/statistical-rethinking-richard-mcelreath">Statistical Rethinking</a> <span class="citation" data-cites="mcelreath2018statistical">[<a href="#ref-mcelreath2018statistical" role="doc-biblioref">1</a>]</span></p>
</section>
<section id="models" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Model(s)</h1>
<p>Tornado counts vary across state, month, and year. One might imagine that climatic factors change over time (across years), that the formation of tornadoes alters within a year, over different months, and that the rate of tornado formation is also affected by local geographical features (state location).</p>
<p>To adequately incorporate information across these categories, we can create a <a href="https://en.wikipedia.org/wiki/Multilevel_model">multilevel model</a>. For each relevant category (<code>State</code>, <code>Month</code>, <code>Year</code>) available to us, we want to estimate its intercept and internal variation (e.g., across each <code>State</code>, how does tornado count vary?).</p>
<p>Since we are estimating tornado <em>counts</em>, a <a href="https://en.wikipedia.org/wiki/Poisson_distribution">Poisson distribution</a> seems appropriate.</p>
<p>Proceeding, let <span class="math inline">\(\alpha_i\)</span> denote the random effect of the location of state <span class="math inline">\(i\)</span> on expected tornado count. Further, let <span class="math inline">\(\gamma_j\)</span> and <span class="math inline">\(\delta_k\)</span> denote the random of effects of month <span class="math inline">\(j\)</span> on and year <span class="math inline">\(k\)</span>, respectively, on expected tornado count. Let the expected tornado count for state <span class="math inline">\(i\)</span>, month <span class="math inline">\(j\)</span>, and year <span class="math inline">\(k\)</span> be called <span class="math inline">\(Y_{ijk}\)</span>.</p>
<p>The tornado count <span class="math inline">\(T_{ijk}\)</span> for state <span class="math inline">\(i\)</span>, month <span class="math inline">\(j\)</span>, and year <span class="math inline">\(k\)</span> can be modelled via <span class="math inline">\(T_{ijk} \sim \text{Poisson}(Y_{ijk})\)</span>, where <span class="math inline">\(\log (Y_{ijk}) = \alpha_{\text{state}[i]} + \gamma_{\text{month}[j]} + \delta_{\text{year}[k]}\)</span>, i.e.&nbsp;<span class="math inline">\(Y_{ijk}\)</span> is <a href="https://en.wikipedia.org/wiki/Log-linear_model">log-linear</a>.</p>
<p>Note that the author is “uncertain” regarding what constitute “appropriate” priors distributions and parameter values to use for a model on tornadoes. Note also that the author explores these decisions somewhat via a <a href="https://en.wikipedia.org/wiki/Sensitivity_analysis">sensitivity analysis</a>. The prior values for the hyperparameters <span class="math inline">\(\overline{\alpha}\)</span>, <span class="math inline">\(\overline{\gamma}\)</span>, and <span class="math inline">\(\overline{\delta}\)</span> represent the author’s best guess that state effects vary more than year effects vary more than month effects, with respect to tornado count.</p>
<p>Adaptive priors:</p>
<p><span class="math display">\[
\begin{aligned}
\alpha_{i} &amp;\sim \mathcal{N}(\overline{\alpha}, \sigma_{\alpha}) \quad \text{for} \quad i = 1, 2, \dotsc, 50 \\
\gamma_{j} &amp;\sim \mathcal{N}(\overline{\gamma}, \sigma_{\gamma}) \quad \text{for} \quad j = 1, 2, \dotsc, 12  \\
\delta_{k} &amp;\sim \mathcal{N}(\overline{\delta}, \sigma_{\delta}) \quad \text{for} \quad k = 1, 2, \dotsc, 5
\end{aligned}
\]</span></p>
<p>where</p>
<p><span class="math display">\[
\begin{aligned}
\overline{\alpha} &amp;\sim \mathcal{N}(0, \sigma_{\overline{\alpha}}) \\
\overline{\gamma} &amp;\sim \mathcal{N}(0, \sigma_{\overline{\gamma}}) \\
\overline{\delta} &amp;\sim \mathcal{N}(0, \sigma_{\overline{\delta}})
\end{aligned}
\]</span></p>
<p>and</p>
<p><span class="math display">\[
\begin{aligned}
\sigma_{\alpha}, \sigma_{\gamma}, \sigma_{\delta} &amp;\sim \text{Exponential}(1.0)  \\
\sigma_{\overline{\alpha}}, \sigma_{\overline{\gamma}}, \sigma_{\overline{\delta}} &amp;\sim \mathcal{U}(0.0, 6.0)
\end{aligned}
\]</span></p>
<section id="implementation" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="implementation"><span class="header-section-number">2.1</span> Implementation</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> model_01(states<span class="op">=</span><span class="va">None</span>, months<span class="op">=</span><span class="va">None</span>, years<span class="op">=</span><span class="va">None</span>, tornadoes<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># states, months, years, and tornadoes represented</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    num_states <span class="op">=</span> <span class="bu">len</span>(np.unique(states))</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    num_months <span class="op">=</span> <span class="bu">len</span>(np.unique(months))</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    num_years <span class="op">=</span> <span class="bu">len</span>(np.unique(years))</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    num_tornados <span class="op">=</span> <span class="bu">len</span>(tornadoes)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># state effect hyperparameters</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    alpha_mu <span class="op">=</span> npro.sample(<span class="st">"alpha_mu"</span>, dist.Normal(<span class="dv">0</span>, <span class="fl">3.0</span>))</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    alpha_sigma <span class="op">=</span> npro.sample(<span class="st">"alpha_sigma"</span>, dist.Exponential(<span class="fl">1.0</span>))</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># state effect</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> npro.plate(<span class="st">"states"</span>, num_states):</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>        alpha <span class="op">=</span> npro.sample(<span class="st">"alpha"</span>, dist.Normal(alpha_mu, alpha_sigma))</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># month effect hyperparameters</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    gamma_mu <span class="op">=</span> npro.sample(<span class="st">"gamma_mu"</span>, dist.Normal(<span class="dv">0</span>, <span class="fl">1.0</span>))</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    gamma_sigma <span class="op">=</span> npro.sample(<span class="st">"gamma_sigma"</span>, dist.Exponential(<span class="fl">1.0</span>))</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># month effect</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> npro.plate(<span class="st">"months"</span>, num_months):</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>        gamma <span class="op">=</span> npro.sample(<span class="st">"gamma"</span>, dist.Normal(gamma_mu, gamma_sigma))</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># year effect hyperparameters</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    delta_mu <span class="op">=</span> npro.sample(<span class="st">"delta_mu"</span>, dist.Normal(<span class="dv">0</span>, <span class="fl">2.0</span>))</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    delta_sigma <span class="op">=</span> npro.sample(<span class="st">"delta_sigma"</span>, dist.Exponential(<span class="fl">1.0</span>))</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># year effect</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> npro.plate(<span class="st">"years"</span>, num_years):</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>        delta <span class="op">=</span> npro.sample(<span class="st">"delta"</span>, dist.Normal(delta_mu, delta_sigma))</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># expected tornadoes</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    Y <span class="op">=</span> jnp.exp(alpha[states] <span class="op">+</span> gamma[months] <span class="op">+</span> delta[years])</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># likelihood</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> npro.plate(<span class="st">"data"</span>, size<span class="op">=</span>num_tornados):</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>        npro.sample(<span class="st">"obs"</span>, dist.Poisson(Y), obs<span class="op">=</span>tornadoes)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="inference" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="inference"><span class="header-section-number">2.2</span> Inference</h2>
<section id="priors" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="priors"><span class="header-section-number">2.2.1</span> Priors</h3>
</section>
<section id="prior-predictive-check" class="level3" data-number="2.2.2">
<h3 data-number="2.2.2" class="anchored" data-anchor-id="prior-predictive-check"><span class="header-section-number">2.2.2</span> Prior Predictive Check</h3>
</section>
<section id="posterior-predictive-check" class="level3" data-number="2.2.3">
<h3 data-number="2.2.3" class="anchored" data-anchor-id="posterior-predictive-check"><span class="header-section-number">2.2.3</span> Posterior Predictive Check</h3>
</section>
<section id="posterior-samples" class="level3" data-number="2.2.4">
<h3 data-number="2.2.4" class="anchored" data-anchor-id="posterior-samples"><span class="header-section-number">2.2.4</span> Posterior Samples</h3>
</section>
<section id="other-results" class="level3" data-number="2.2.5">
<h3 data-number="2.2.5" class="anchored" data-anchor-id="other-results"><span class="header-section-number">2.2.5</span> Other Results</h3>
</section>
</section>
</section>
<section id="appendix" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> <a href="#appendix">Appendix</a></h1>
<section id="random-intercepts-and-slopes" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="random-intercepts-and-slopes"><span class="header-section-number">3.1</span> Random Intercepts And Slopes</h2>
<p>From the Wikipedia page on multilevel models (linked earlier), accessed 2024-04-20.</p>
<blockquote class="blockquote">
<p>Before conducting a multilevel model analysis, a researcher must decide on several aspects, including which predictors are to be included in the analysis, if any. Second, the researcher must decide whether parameter values (i.e., the elements that will be estimated) will be fixed or random.<sup><a href="https://en.wikipedia.org/wiki/Multilevel_model#cite_note-Fidell-2">[2]</a><a href="https://en.wikipedia.org/wiki/Multilevel_model#cite_note-Cohen-5">[5]</a><a href="https://en.wikipedia.org/wiki/Multilevel_model#cite_note-Gomes2022-4">[4]</a></sup> Fixed parameters are composed of a constant over all the groups, whereas a random parameter has a different value for each of the groups.<sup><a href="https://en.wikipedia.org/wiki/Multilevel_model#cite_note-Gomes2022-4">[4]</a></sup> Additionally, the researcher must decide whether to employ a maximum likelihood estimation or a restricted maximum likelihood estimation type.<sup><a href="https://en.wikipedia.org/wiki/Multilevel_model#cite_note-Fidell-2">[2]</a></sup></p>
<p><strong>Random intercepts model</strong></p>
<p>A random intercepts model is a model in which intercepts are allowed to vary, and therefore, the scores on the dependent variable for each individual observation are predicted by the intercept that varies across groups.<sup><a href="https://en.wikipedia.org/wiki/Multilevel_model#cite_note-Cohen-5">[5]</a><a href="https://en.wikipedia.org/wiki/Multilevel_model#cite_note-Garson-8">[8]</a><a href="https://en.wikipedia.org/wiki/Multilevel_model#cite_note-Gomes2022-4">[4]</a></sup> This model assumes that slopes are fixed (the same across different contexts). In addition, this model provides information about <a href="https://en.wikipedia.org/wiki/Intraclass_correlation" title="Intraclass correlation">intraclass correlations</a>, which are helpful in determining whether multilevel models are required in the first place.<sup><a href="https://en.wikipedia.org/wiki/Multilevel_model#cite_note-Fidell-2">[2]</a></sup></p>
<p><strong>Random slopes model</strong></p>
<p>A random slopes model is a model in which slopes are allowed to vary according to a correlation matrix, and therefore, the slopes are different across grouping variable such as time or individuals. This model assumes that intercepts are fixed (the same across different contexts).<sup><a href="https://en.wikipedia.org/wiki/Multilevel_model#cite_note-Cohen-5">5</a></sup></p>
<p><strong>Random intercepts and slopes model</strong></p>
<p>A model that includes both random intercepts and random slopes is likely the most realistic type of model, although it is also the most complex. In this model, both intercepts and slopes are allowed to vary across groups, meaning that they are different in different contexts.<sup><a href="https://en.wikipedia.org/wiki/Multilevel_model#cite_note-Cohen-5">5</a></sup></p>
</blockquote>
</section>
<section id="mcelreath-multilevel-modelling" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="mcelreath-multilevel-modelling"><span class="header-section-number">3.2</span> McElreath Multilevel Modelling</h2>
<p>Description from pp.&nbsp;400 of the 2nd edition of Statistical Rethinking:</p>
<div class="bquote">
<p>These models remember features of each cluster in the data as they learn about all of the clusters. Depending upon the variation among clusters, which is learned from the data as well, the model pools information across clusters. This pooling tends to improve estimates about each cluster. This improved estimation leads to several, more prag- matic sounding, benefits of the multilevel approach. I mentioned them in Chapter 1. They are worth repeating.</p>
<ol type="1">
<li><p>Improved estimates for repeat sampling. When more than one observation arises from the same individual, location, or time, then traditional, single-level models either maximally underfit or overfit the data.</p></li>
<li><p>Improved estimates for imbalance in sampling. When some individuals, locations, or times are sampled more than others, multilevel models automatically cope with differing uncertainty across these clusters. This prevents over-sampled clusters from unfairly dominating inference.</p></li>
<li><p>Estimates of variation. If our research questions include variation among individu- also or other groups within the data, then multilevel models are a big help, because they model variation explicitly.</p></li>
<li><p>Avoid averaging, retain variation. Frequently, scholars pre-average some data to construct variables. This can be dangerous, because averaging removes variation, and there are also typically several different ways to perform the averaging. Aver- aging therefore both manufactures false confidence and introduces arbitrary datatransformations. Multilevel models allow us to preserve the uncertainty and avoid data transformations</p></li>
</ol>
</div>
<p>Description from pp.&nbsp;401 of the 2nd edition of Statistical Rethinking:</p>
<div class="bquote">
<p>Rethinking: A model by any other name. Multilevel models go by many different names, and some statisticians use the same names for different specialized variants, while others use them all inter- changeably. The most common synonyms for “multilevel” are hierarchical and mixed effects. The type of parameters that appear in multilevel models are most commonly known as random ef- fects, which itself can mean very different things to different analysts and in different contexts.193 And even the innocent term “level” can mean different things to different people. There’s really no cure for this swamp of vocabulary aside from demanding a mathematical or algorithmic definition of the model. Otherwise, there will always be ambiguity</p>
</div>
<!-- ## Notes

* Have a tree diagram in the README.
* Have Mermaid model in the README for each model.
* Have Discussion on Tornadoes Dynamics.
* Have Discussion on each Model type.
* Data file only run once.
* Save, Transform, Vis works across Models.
* Models can save information in clean way.
* Have Resources section with layout of the information and Discussions.
* &rarr; Considerations For Model Repos. In General
  * Branch Protection
  * CONTRIBUTING.md
  * ISSUE TEMPLATE
* Discussion on Save, Transform, Vis., Data patterns.
* Selecting baseline model
* Decision for where to store data visualization-->
</section>
<section id="references" class="level2" data-number="3.3">




</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">3.3 References</h2><div id="refs" class="references csl-bib-body" role="list">
<div id="ref-mcelreath2018statistical" class="csl-entry" role="listitem">
[1] MCELREATH, R. <em>Statistical rethinking: A bayesian course with examples in r and stan</em>. B.m.: Chapman; Hall/CRC, 2018.
</div>
</div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{2024,
  author = {, O957},
  title = {A {Multilevel} {Regression} {Model} {For} {Tornadoes,} {In}
    {Python}},
  date = {2024-09-01},
  url = {https://O957.github.io/Aggregated-Model-Descriptions/AMLRMFTIP-UPX3/index.html},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-2024" class="csl-entry quarto-appendix-citeas" role="listitem">
[1] O. <em>A Multilevel Regression Model For Tornadoes, In Python</em>
[online]. 1. September 2024. Retrieved from: <a href="https://O957.github.io/Aggregated-Model-Descriptions/AMLRMFTIP-UPX3/index.html">https://O957.github.io/Aggregated-Model-Descriptions/AMLRMFTIP-UPX3/index.html.
</a>
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/O957\.github\.io\/Aggregated-Model-Descriptions\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2024, O957</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>